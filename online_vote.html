<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="./assets/icon.png">
    <title>Online Voting System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: #2c3e50;
            color: white;
            padding: 20px 0;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 2.5rem;
        }
        
        .nav {
            display: flex;
            justify-content: center;
            background-color: #34495e;
            padding: 10px 0;
            margin-bottom: 30px;
        }
        
        .nav a {
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            margin: 0 10px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        
        .nav a:hover {
            background-color: #2c3e50;
        }
        
        .page {
            display: none;
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        .btn-danger {
            background-color: #e74c3c;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .btn-success {
            background-color: #2ecc71;
        }
        
        .btn-success:hover {
            background-color: #27ae60;
        }
        
        .candidates-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .candidate-card {
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 8px;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .candidate-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .candidate-card h3 {
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .vote-btn {
            margin-top: 15px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        
        tr:hover {
            background-color: #f5f5f5;
        }
        
        .admin-login {
            max-width: 500px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .admin-panel {
            display: none;
        }
        
        .logout-btn {
            background-color: #e74c3c;
            margin-top: 20px;
        }
        
        .logout-btn:hover {
            background-color: #c0392b;
        }
        
        .result-chart {
            margin-top: 30px;
            height: 400px;
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 20px;
            position: relative;
        }
        
        .chart-bar {
            background-color: #3498db;
            height: 40px;
            margin-bottom: 15px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            padding-left: 15px;
            color: white;
            font-weight: bold;
            transition: width 0.5s ease;
        }
        
        .alert {
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        
        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-danger {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .about-section {
            padding: 50px;
            text-align: center;
        }
        .about-container {
            /* max-width: 900px; */
            margin: auto;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
        }
        .about-text {
            flex: 1;
            padding: 20px;
            text-align: left;
        }
        .about-text h2 {
            color: #2c3e50;
        }
        .about-text p {
            color: #555;
            font-size: 18px;
            line-height: 1.6;
        }
        .about-image {
            flex: 1;
            text-align: center;
        }
        .about-image img {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <img src="./assets/Voting online.jpeg" alt="Logo" style="position: absolute; top: 10px; left: 10px; width: 100px; padding-top: 20px;">
            <h1>Online Voting System</h1>
        </div>
    </header>
    
    <div class="nav">
        <div class="container">
            <a href="#" onclick="showPage('about')">About</a>
            <a href="#" onclick="showPage('home')">Home</a>
            <a href="#" onclick="showPage('voter')">Voter Portal</a>
            <a href="#" onclick="showPage('admin-login')">Admin Portal</a>
            <a href="#" onclick="showPage('results')">View Results</a>
        </div>
    </div>
    
    <div class="container">
        <!--About Page-->
        <div id="about" class="page">
            <section class="about-section">
                <div class="about-container">
                    <div class="about-text" style="display: inline-block;">
                        <p>
                            Our Online Voting System ensures a secure, transparent, and fair election process.
                            Voters can cast their votes electronically, reducing manual errors and ensuring accuracy.
                        </p>
                        <p>
                            Built with the latest security features, the system prevents fraud and guarantees the integrity of elections.
                            Join us in making voting easier and accessible for everyone!
                        </p>
                    </div>
                    <div class="about-image" style="display: inline-block;">
                        <img src="./assets/about.jpeg" alt="Online Voting">
                    </div>
                </div>
        
            </section>
            <section class=" about-section">
                <div class="about-container">
                    <div class="about-text">
                        <p>In today's increasingly digital world, our online voting system offers a secure, efficient, and accessible alternative to traditional polling methods.  We understand the importance of fair and transparent elections, and our platform is designed with the highest security standards to ensure the integrity of every vote.  Voters can conveniently cast their ballots from the comfort of their homes or any location with internet access, eliminating the need to travel to physical polling stations and increasing voter turnout.  Our system is user-friendly and intuitive, guiding voters through the process with ease.</p>
                        <p>For election administrators, our platform provides a comprehensive suite of tools to manage all aspects of the election, from candidate registration and ballot creation to real-time results monitoring and detailed reporting.  We employ robust encryption and multi-factor authentication to protect voter data and prevent fraud, ensuring that every vote is cast securely and accurately.  Our system also promotes transparency by providing clear audit trails and verifiable results.</p>
                        <p>By embracing technology, our online voting system modernizes the electoral process, making it more accessible, convenient, and secure for all participants.  We are committed to upholding the principles of democracy and empowering communities through innovative and reliable voting solutions.</p>
                    </div>
                </div>
            </section>
            <footer style="background-color:#34495e; color: white; padding: 13px;">
                <br>
                <h1>Team: </h1>
                <br>
                <h3>23BDS1076 : PATEL KAVYA VIPULKUMAR</h3>
                <h3>23BDS1151 : TAPAN BATLA</h3>
                <h3>23BDS1160 : ANOK ANIL THOMAS</h3>
            </footer>
        </div>
        <!-- Home Page -->
        <div id="home" class="page active">
            <h2>Welcome to Online Voting System</h2>
            <p>Cast your vote securely and conveniently from anywhere.</p>
            <div style="margin-top: 30px;">
                <h3>How to Vote:</h3>
                <ol style="margin-top: 15px; margin-left: 20px;">
                    <li>Go to Voter Portal</li>
                    <li>Enter your name and voter ID</li>
                    <li>Select your preferred candidate</li>
                    <li>Click "Vote" to submit your choice</li>
                </ol>
            </div>
            <div style="margin-top: 30px;">
                <button onclick="showPage('voter')" class="btn-success">Go to Voter Portal</button>
                <button onclick="showPage('results')" style="margin-left: 10px;">View Current Results</button>
            </div>
        </div>

        <!-- Voter Login Page -->
        <div id="voter-login" class="page">
            <h2>Voter Login</h2>
            <p>Please enter your details to proceed to voting</p>
            <div id="voter-login-alert" class="alert" style="display: none;"></div>
            <form id="voter-login-form">
                <div class="form-group">
                    <label for="voter-name">Full Name</label>
                    <input type="text" id="voter-name" required placeholder="Enter your full name">
                </div>
                <div class="form-group">
                    <label for="voter-id">Voter ID</label>
                    <input type="text" id="voter-id" required placeholder="Enter your voter ID">
                </div>
                <button type="submit" class="btn-success">Proceed to Vote</button>
            </form>
        </div>
        
        <!-- Voter Page -->
        <div id="voter" class="page">
            <div id="voter-info" style="margin-bottom: 20px;">
                <h2>Cast Your Vote</h2>
                <p>Welcome, <span id="display-voter-name"></span> (Voter ID: <span id="display-voter-id"></span>)</p>
            </div>
            
            <div id="voter-alert" class="alert" style="display: none;"></div>
            
            <h3>Available Candidates</h3>
            <div id="candidates-list" class="candidates-list">
                <!-- Candidates will be loaded here -->
            </div>
            
            <div style="margin-top: 30px;">
                <button onclick="showPage('results')">View Current Results</button>
            </div>
        </div>
        
        <!-- Admin Login Page -->
        <div id="admin-login" class="page">
            <div class="admin-login">
                <h2>Admin Login</h2>
                <div id="admin-login-alert" class="alert" style="display: none;"></div>
                <form id="admin-login-form">
                    <div class="form-group">
                        <label for="admin-username">Username</label>
                        <input type="text" id="admin-username" required placeholder="Enter admin username">
                    </div>
                    <div class="form-group">
                        <label for="admin-password">Password</label>
                        <input type="password" id="admin-password" required placeholder="Enter admin password">
                    </div>
                    <button type="submit" class="btn-success">Login</button>
                </form>
            </div>
        </div>
        
        <!-- Admin Panel -->
        <div id="admin-panel" class="page">
            <h2>Admin Panel</h2>
            <p>Manage candidates and view voting details</p>
            
            <div id="admin-alert" class="alert" style="display: none;"></div>
            
            <div style="margin-top: 30px;">
                <button onclick="showPage('results')">View Results</button>
                <button onclick="logoutAdmin()" class="logout-btn" style="margin-left: 10px;">Logout</button>
            </div>
            
            <div style="margin-top: 30px;">
                <h3>Add New Candidate</h3>
                <form id="add-candidate-form" style="margin-top: 15px;">
                    <div class="form-group">
                        <label for="candidate-name">Candidate Name</label>
                        <input type="text" id="candidate-name" required placeholder="Enter candidate name">
                    </div>
                    <div class="form-group">
                        <label for="candidate-id">Candidate ID</label>
                        <input type="text" id="candidate-id" required placeholder="Enter unique candidate ID">
                    </div>
                    <button type="submit" class="btn-success">Add Candidate</button>
                </form>
            </div>
            
            <div style="margin-top: 30px;">
                <h3>Current Candidates</h3>
                <div id="admin-candidates-list" class="candidates-list">
                    <!-- Candidates will be loaded here -->
                </div>
            </div>
            
            <div style="margin-top: 30px;">
                <h3>Voter List</h3>
                <table id="voters-table">
                    <thead>
                        <tr>
                            <th>Voter Name</th>
                            <th>Voter ID</th>
                            <th>Voted For</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Voters will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Results Page -->
        <div id="results" class="page">
            <h2>Voting Results</h2>
            <p>Current standings in the election</p>
            
            <div id="results-alert" class="alert" style="display: none;"></div>
            
            <div class="result-chart" id="result-chart">
                <!-- Chart will be generated here -->
            </div>
            
            <table style="margin-top: 30px;">
                <thead>
                    <tr>
                        <th>Candidate Name</th>
                        <th>Candidate ID</th>
                        <th>Votes Received</th>
                    </tr>
                </thead>
                <tbody id="results-table-body">
                    <!-- Results will be loaded here -->
                </tbody>
            </table>
            
            <div style="margin-top: 30px;">
                <button onclick="goBack()">Go Back</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize data in localStorage if not exists
        if (!localStorage.getItem('candidates')) {
            localStorage.setItem('candidates', JSON.stringify([]));
        }
        
        if (!localStorage.getItem('voters')) {
            localStorage.setItem('voters', JSON.stringify([]));
        }
        
        if (!localStorage.getItem('votes')) {
            localStorage.setItem('votes', JSON.stringify({}));
        }
        
        // Admin credentials (in a real app, this would be server-side)
        const ADMIN_CREDENTIALS = {
            username: "admin",
            password: "admin123"
        };
        
        // Current user session
        let currentVoter = null;
        let isAdminLoggedIn = false;
        
        // DOM elements
        const pages = document.querySelectorAll('.page');
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Set up form event listeners
            document.getElementById('voter-login-form').addEventListener('submit', handleVoterLogin);
            document.getElementById('add-candidate-form').addEventListener('submit', handleAddCandidate);
            document.getElementById('admin-login-form').addEventListener('submit', handleAdminLogin);
            
            // Show home page by default
            showPage('home');
        });
        
        // Show specific page and hide others
        function showPage(pageId) {
            // Special handling for admin pages
            if (pageId === 'admin-panel' && !isAdminLoggedIn) {
                showPage('admin-login');
                return;
            }
            
            // Special handling for voter pages
            if (pageId === 'voter' && !currentVoter) {
                showPage('voter-login');
                return;
            }
            
            pages.forEach(page => {
                page.classList.remove('active');
                if (page.id === pageId) {
                    page.classList.add('active');
                }
            });
            
            // Load data for specific pages
            if (pageId === 'voter') {
                loadCandidatesForVoting();
                document.getElementById('display-voter-name').textContent = currentVoter.name;
                document.getElementById('display-voter-id').textContent = currentVoter.id;
            } else if (pageId === 'admin-panel') {
                loadAdminCandidates();
                loadVotersList();
            } else if (pageId === 'results') {
                loadResults();
            }
        }
        
        // Handle voter login
        function handleVoterLogin(e) {
            e.preventDefault();
            
            const name = document.getElementById('voter-name').value.trim();
            const id = document.getElementById('voter-id').value.trim();
            
            // Basic validation
            if (!name || !id) {
                showAlert('voter-login-alert', 'Please enter both name and voter ID', 'danger');
                return;
            }
            
            // Check if voter already voted
            const voters = JSON.parse(localStorage.getItem('voters'));
            const existingVoter = voters.find(voter => voter.id === id);
            
            if (existingVoter && existingVoter.voted) {
                showAlert('voter-login-alert', 'You have already voted', 'danger');
                return;
            }
            
            // Set current voter
            currentVoter = { name, id };
            
            // If new voter, add to list
            if (!existingVoter) {
                voters.push({ name, id, voted: false });
                localStorage.setItem('voters', JSON.stringify(voters));
            }
            
            // Proceed to voting
            showPage('voter');
        }
        
        // Handle admin login
        function handleAdminLogin(e) {
            e.preventDefault();
            
            const username = document.getElementById('admin-username').value.trim();
            const password = document.getElementById('admin-password').value.trim();
            
            if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                isAdminLoggedIn = true;
                showPage('admin-panel');
            } else {
                showAlert('admin-login-alert', 'Invalid credentials', 'danger');
            }
        }
        
        // Logout admin
        function logoutAdmin() {
            isAdminLoggedIn = false;
            document.getElementById('admin-username').value = '';
            document.getElementById('admin-password').value = '';
            showPage('home');
        }
        
        // Handle adding new candidate
        function handleAddCandidate(e) {
            e.preventDefault();
            
            const name = document.getElementById('candidate-name').value.trim();
            const id = document.getElementById('candidate-id').value.trim();
            
            if (!name || !id) {
                showAlert('admin-alert', 'Please enter both name and ID', 'danger');
                return;
            }
            
            const candidates = JSON.parse(localStorage.getItem('candidates'));
            
            // Check if candidate ID already exists
            if (candidates.some(candidate => candidate.id === id)) {
                showAlert('admin-alert', 'Candidate ID already exists', 'danger');
                return;
            }
            
            // Add new candidate
            candidates.push({ name, id });
            localStorage.setItem('candidates', JSON.stringify(candidates));
            
            // Initialize vote count if not exists
            const votes = JSON.parse(localStorage.getItem('votes'));
            if (!votes[id]) {
                votes[id] = 0;
                localStorage.setItem('votes', JSON.stringify(votes));
            }
            
            // Clear form and show success
            document.getElementById('candidate-name').value = '';
            document.getElementById('candidate-id').value = '';
            showAlert('admin-alert', 'Candidate added successfully', 'success');
            
            // Refresh candidates list
            loadAdminCandidates();
        }
        
        // Load candidates for voting page
        function loadCandidatesForVoting() {
            const candidates = JSON.parse(localStorage.getItem('candidates'));
            const container = document.getElementById('candidates-list');
            container.innerHTML = '';
            
            if (candidates.length === 0) {
                container.innerHTML = '<p>No candidates available</p>';
                return;
            }
            
            candidates.forEach(candidate => {
                const card = document.createElement('div');
                card.className = 'candidate-card';
                card.innerHTML = `
                    <h3>${candidate.name}</h3>
                    <p>ID: ${candidate.id}</p>
                    <button onclick="castVote('${candidate.id}')" class="vote-btn btn-success">Vote for ${candidate.name}</button>
                `;
                container.appendChild(card);
            });
        }
        
        // Load candidates for admin page
        function loadAdminCandidates() {
            const candidates = JSON.parse(localStorage.getItem('candidates'));
            const container = document.getElementById('admin-candidates-list');
            container.innerHTML = '';
            
            if (candidates.length === 0) {
                container.innerHTML = '<p>No candidates added yet</p>';
                return;
            }
            
            candidates.forEach(candidate => {
                const card = document.createElement('div');
                card.className = 'candidate-card';
                card.innerHTML = `
                    <h3>${candidate.name}</h3>
                    <p>ID: ${candidate.id}</p>
                    <button onclick="removeCandidate('${candidate.id}')" class="btn-danger">Remove Candidate</button>
                `;
                container.appendChild(card);
            });
        }
        
        // Load voters list for admin
        function loadVotersList() {
            const voters = JSON.parse(localStorage.getItem('voters'));
            const votes = JSON.parse(localStorage.getItem('votes'));
            const tbody = document.querySelector('#voters-table tbody');
            tbody.innerHTML = '';
            
            voters.forEach(voter => {
                const row = document.createElement('tr');
                
                // Find out who the voter voted for (if they voted)
                let votedFor = 'Not voted yet';
                if (voter.voted) {
                    for (const [candidateId, voteCount] of Object.entries(votes)) {
                        if (voteCount > 0) {
                            const candidates = JSON.parse(localStorage.getItem('candidates'));
                            const candidate = candidates.find(c => c.id === candidateId);
                            if (candidate) {
                                votedFor = candidate.name;
                                break;
                            }
                        }
                    }
                }
                
                row.innerHTML = `
                    <td>${voter.name}</td>
                    <td>${voter.id}</td>
                    <td>${votedFor}</td>
                `;
                tbody.appendChild(row);
            });
        }
        
        // Cast a vote
        function castVote(candidateId) {
            if (!currentVoter) {
                showAlert('voter-alert', 'Please login first', 'danger');
                showPage('voter-login');
                return;
            }
            
            // Check if already voted
            const voters = JSON.parse(localStorage.getItem('voters'));
            const voterIndex = voters.findIndex(v => v.id === currentVoter.id);
            
            if (voterIndex !== -1 && voters[voterIndex].voted) {
                showAlert('voter-alert', 'You have already voted', 'danger');
                return;
            }
            
            // Update vote count
            const votes = JSON.parse(localStorage.getItem('votes'));
            votes[candidateId] = (votes[candidateId] || 0) + 1;
            localStorage.setItem('votes', JSON.stringify(votes));
            
            // Mark voter as voted
            if (voterIndex !== -1) {
                voters[voterIndex].voted = true;
                localStorage.setItem('voters', JSON.stringify(voters));
            }
            
            // Show success message
            showAlert('voter-alert', 'Your vote has been cast successfully!', 'success');
            
            // Disable voting buttons
            const voteButtons = document.querySelectorAll('.vote-btn');
            voteButtons.forEach(button => {
                button.disabled = true;
                button.textContent = 'Voted';
                button.classList.remove('btn-success');
                button.style.backgroundColor = '#95a5a6';
            });
        }
        
        // Remove a candidate
        function removeCandidate(candidateId) {
            if (!confirm('Are you sure you want to remove this candidate? All votes for this candidate will be lost.')) {
                return;
            }
            
            // Remove from candidates list
            const candidates = JSON.parse(localStorage.getItem('candidates'));
            const updatedCandidates = candidates.filter(c => c.id !== candidateId);
            localStorage.setItem('candidates', JSON.stringify(updatedCandidates));
            
            // Remove from votes
            const votes = JSON.parse(localStorage.getItem('votes'));
            delete votes[candidateId];
            localStorage.setItem('votes', JSON.stringify(votes));
            
            // Update UI
            showAlert('admin-alert', 'Candidate removed successfully', 'success');
            loadAdminCandidates();
        }
        
        // Load results
        function loadResults() {
            const candidates = JSON.parse(localStorage.getItem('candidates'));
            const votes = JSON.parse(localStorage.getItem('votes'));
            const tbody = document.getElementById('results-table-body');
            const chart = document.getElementById('result-chart');
            
            tbody.innerHTML = '';
            chart.innerHTML = '';
            
            if (candidates.length === 0) {
                tbody.innerHTML = '<tr><td colspan="3">No candidates available</td></tr>';
                chart.innerHTML = '<p>No voting data available</p>';
                return;
            }
            
            // Calculate total votes
            let totalVotes = 0;
            candidates.forEach(candidate => {
                totalVotes += votes[candidate.id] || 0;
            });
            
            // Sort candidates by votes (descending)
            candidates.sort((a, b) => (votes[b.id] || 0) - (votes[a.id] || 0));
            
            // Display results in table
            candidates.forEach(candidate => {
                const voteCount = votes[candidate.id] || 0;
                const percentage = totalVotes > 0 ? (voteCount / totalVotes * 100).toFixed(1) : 0;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${candidate.name}</td>
                    <td>${candidate.id}</td>
                    <td>${voteCount} (${percentage}%)</td>
                `;
                tbody.appendChild(row);
                
                // Add to chart
                if (totalVotes > 0) {
                    const bar = document.createElement('div');
                    bar.className = 'chart-bar';
                    bar.style.width = `${percentage}%`;
                    bar.textContent = `${candidate.name}: ${voteCount} votes (${percentage}%)`;
                    chart.appendChild(bar);
                }
            });
            
            if (totalVotes === 0) {
                chart.innerHTML = '<p>No votes have been cast yet</p>';
            }
        }
        
        // Show alert message
        function showAlert(elementId, message, type) {
            const alertElement = document.getElementById(elementId);
            alertElement.textContent = message;
            alertElement.style.display = 'block';
            alertElement.className = `alert alert-${type}`;
            
            // Hide alert after 5 seconds
            setTimeout(() => {
                alertElement.style.display = 'none';
            }, 5000);
        }
        
        // Go back to previous page
        function goBack() {
            if (isAdminLoggedIn) {
                showPage('admin-panel');
            } else if (currentVoter) {
                showPage('voter');
            } else {
                showPage('home');
            }
        }
    </script>
</body>
</html>